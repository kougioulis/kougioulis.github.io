<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://nkougioulis.com/feed.xml" rel="self" type="application/atom+xml"/><link href="https://nkougioulis.com/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-06-05T10:26:49+00:00</updated><id>https://nkougioulis.com/feed.xml</id><title type="html">blank</title><subtitle></subtitle><entry><title type="html">Glove80: Keyboard Endgame?</title><link href="https://nkougioulis.com/blog/2025/glove80/" rel="alternate" type="text/html" title="Glove80: Keyboard Endgame?"/><published>2025-06-05T08:00:00+00:00</published><updated>2025-06-05T08:00:00+00:00</updated><id>https://nkougioulis.com/blog/2025/glove80</id><content type="html" xml:base="https://nkougioulis.com/blog/2025/glove80/"><![CDATA[<h3 id="introduction">Introduction</h3> <div class="row justify-content-sm-center"> <div class="col-sm-auto text-center mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Glove80-main-img-768x432-480.webp 480w,/assets/img/Glove80-main-img-768x432-800.webp 800w,/assets/img/Glove80-main-img-768x432-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/Glove80-main-img-768x432.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Glove80 Typing Illustration" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <div class="caption mt-2" style="text-align: center;">Glove80 in action, in white color and palm rests. Taken explicitely from <a href="https://develop3d.com/product-design/fits-like-a-glove80-designed-for-keyboard-comfort/">Develop3D</a>.</div> </div> </div> <p>There comes a point in life where you need to take a step back from your average keyboard and opt for a more ergonomic choice. Personally, this rite of passage came after working long hours; software engineering and writing consist of a lot of keystrokes. My fingers were begging me for a better typing alternative. Now would you consider yourself lucky or unlucky in this case? Apart from the weird looks you may get at the office due to the abnormal look of your typing gear, there are a plethora of advantages in using ergonomic keyboards, such as reduced wrist pain, tendon strain and reduced chances for RSI and Carpal Tunnel Syndrome. I would even add they prevent hunching over the keyboard like a monkey. Although a considerable disadvantage is that they come with a hefty price tag, since (to my surpris) they represent a niche market, I‚Äôd assume that initial investment would cost less than any future visits to any doctor and rehabilitation specialist. The pioneering brand <a href="https://kinesis-ergo.com/">Kinesisgg</a>, which was the first to introduce contoured keyboards back in 1992, offers a <a href="https://kinesis-ergo.com/split-keyboards/">lengthy post on reasons to choose a split ergonomic keyboard</a>. In their view‚Äîand now mine‚Äîtraditional keyboards have several ergonomic flaws, such as:</p> <ul> <li><b>Ulnar deviation</b>: This occurs when wrists bend outward (towards the side of the pinky ) to reach the home row on a standard keyboard. Since the keyboard is a single flat slab, the hands have to angle inward unnaturally to reach the keys, placing strain on your wrists and forearms.</li> <li><b>Forearm pronation</b>: Traditional keyboards force your palms to rest flat on the desk, with your forearms rotated inward (palms down). This posture twists the forearm bones and tenses up the muscles, reducing blood flow and increasing fatigue.</li> <li><b>Wrist extension</b>: Most conventional keyboards are higher in the back, which causes the wrists to bend upward when typing. This ‚Äúextension‚Äù posture compresses the carpal tunnel and adds tension to the tendons‚Äîespecially bad for long sessions.</li> <li><b>Mouse overreach</b>: Because the keyboard is a single block, your right hand has to reach around or over the number pad to get to the mouse. This leads to unnecessary shoulder and arm strain over time.</li> </ul> <p>In a nutshell, modern ergonomic keyboards eliminate the above problems by spliting the keyboard into two halves, one left and one right. This way, not only is the user able to type with their hands on shoulder width, but also encourages learning correct typing practices. For instance, many people overreach keys with the wrong finger‚Äîlike pressing the ‚ÄúU‚Äù with the left index finger instead of the right. I discovered several of my own bad typing habits this way‚Äîhabits that had become deeply ingrained after years of using traditional keyboards. The mouse is most usually placed in the middle of the two halves.</p> <div class="row justify-content-sm-center"> <div class="col-sm-3 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ulnar-deviation-problem-300x219-480.webp 480w,/assets/img/ulnar-deviation-problem-300x219-800.webp 800w,/assets/img/ulnar-deviation-problem-300x219-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/ulnar-deviation-problem-300x219.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Ulnar deviation problem" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm-3 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/forearm-pronation-problem-300x21-480.webp 480w,/assets/img/forearm-pronation-problem-300x21-800.webp 800w,/assets/img/forearm-pronation-problem-300x21-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/forearm-pronation-problem-300x21.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Forearm pronation problem" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm-3 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/wrist-extension-problem-300x219-480.webp 480w,/assets/img/wrist-extension-problem-300x219-800.webp 800w,/assets/img/wrist-extension-problem-300x219-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/wrist-extension-problem-300x219.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Wrist extension problem" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm-3 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mouse-overreach-problem-300x219-480.webp 480w,/assets/img/mouse-overreach-problem-300x219-800.webp 800w,/assets/img/mouse-overreach-problem-300x219-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/mouse-overreach-problem-300x219.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Mouse overreach problem" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption">Ergonomic risk factors of traditional keyboards: ulnar deviation, forearm pronation, wrist extension, and mouse overreach. Illustrations courtesy of <a href="https://kinesis-ergo.com/solutions/keyboard-risk-factors">Kinesis Corporation</a>.</div> </div> <p>Being based in Europe, choices are a bit limited. A plethora of starting boards are available from <a href="https://splitkb.com/collections/keyboard-kits">splitkb.com</a>, either pre-soldered or unsoldered (as a DIY kit). Being a complete rookie with split keyboards (and mechanical, ortholinear keyboards in general), I found all of them, including the highly popular <a href="https://www.boardsource.xyz/products/Corne">Corne</a> model, to have too few buttons for my liking (I want F keys, numbers and arrow buttons). As such, after weeks of roaming the internet forums, the final considerations compiled were: The range of products by Kinesis, especially the wireless <a href="https://kinesis-ergo.com/keyboards/advantage360/">Advantage 360</a>, the <a href="https://www.moergo.com/">Glove80</a> from MoErgo and the <a href="https://dygma.com/pages/defy">Dygma Defy</a>. Both the Advantage 360 and the Defy turned out to be considerably more expensive once features like RGB underglow, tenting, Bluetooth connectivity and palmrests were added (all of which come standard to the Glove80), let alone import duties. After reading a wave of glowing reviews, the final choice was, frankly, a no-brainer. One a side one, I ended up paying no import duties, although shipped from China, because apparently keyboards have 0% import duties.</p> <div class="row justify-content-sm-center"> <div class="col-sm-auto text-center mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/MoErgoCherryBlossom-480.webp 480w,/assets/img/MoErgoCherryBlossom-800.webp 800w,/assets/img/MoErgoCherryBlossom-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/MoErgoCherryBlossom.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="MoErgo Cherry Blossom Illustration" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <div class="caption mt-2" style="text-align: center;">The company also offers a <a href="https://www.moergo.com/pages/glove80-key-switches">variety of key switch choices</a>. I opted for the newly introduced exclusive Cherry Blossom üå∏ 30gf silent switches, based on the Kailh Choc switch. The latter are also paired with clear cases for better RGB when turned on and is ideal for use in communal places such as the office or the library. As I found out, they are indeed barely audible and typing on them feels crazy comfortable. Two colors for the body are available, white and black (although they refer to it as grey). I opted for the cleaner white look, matching the keycaps.</div> </div> </div> <h3 id="features-of-the-glove80">Features of the Glove80</h3> <div class="row justify-content-sm-center"> <div class="col-sm-auto text-center mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/F4QCWBuagAAKK8O-480.webp 480w,/assets/img/F4QCWBuagAAKK8O-800.webp 800w,/assets/img/F4QCWBuagAAKK8O-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/F4QCWBuagAAKK8O.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Glove80 Travel Case" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <div class="caption mt-2" style="text-align: center;">The MoErgo travel case, taken from MoErgo's Twitter post. Mine shipped with two pouches instead of the shown cylinder cases.</div> </div> </div> <p>The Glove80 comes packed with an impressive list of features that cater to both ergonomic purists and mechanical keyboard enthusiasts:</p> <ul> <li>Fully mechanical, ortholinear design (switches can be lubed with a thin-viscosity oil for even smoother feel)</li> <li>Wireless full-split layout</li> <li>Concave keywells for natural finger positioning</li> <li>6-key, 2-row curved thumb clusters</li> <li>Adjustable tenting with magnetic feet</li> <li>USB-C and Bluetooth connectivity</li> <li>Detachable palm rests</li> <li>80 keys with hot-swappable keycaps</li> </ul> <p>I personally opted to not using the palm rests, although prominment in other ergonomic keyboards too like the Kinesis Advantage 360, as I prefer my wrists resting lower, using a high tenting angle. The keyboard also ships with a travel case ‚Äî though frankly, it‚Äôs a bit bulky for carrying around, although the creators have given a lot of attention to designing it, as explained in <a href="https://www.reddit.com/r/ErgoMechKeyboards/comments/16yn5hg/ad_lessons_learned_from_designing_a_travel_case/">this Reddit post</a>. I find myself wrapping the halves in a cloth and tossing them in my backpack instead. Fortunately, they‚Äôre lighter than I expected, which makes them easy to carry around. That said, I wouldn‚Äôt mind a bit more weight for extra stability during desk use.</p> <div class="row justify-content-sm-center"> <div class="col-sm-auto text-center mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/White-no-palm-rest-angle-1200x1200-480.webp 480w,/assets/img/White-no-palm-rest-angle-1200x1200-800.webp 800w,/assets/img/White-no-palm-rest-angle-1200x1200-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/White-no-palm-rest-angle-1200x1200.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="MoErgo Glove80" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <div class="caption mt-2" style="text-align: center;">The Glove80 keyboard (white version), pictured without the detachable palm rests and with the Kailh Choc switches. Courtesy of MoErgo.</div> </div> </div> <h3 id="initial-impressions">Initial Impressions</h3> <p>The moment I first tried typing on the Glove80, I was humbled ‚Äî barely managing 9 WPM on <a href="https://monkeytype.com">monkeytype.com</a>. That instant made me question whether investing in such a niche piece of gear was worth it or if I had just tossed my money away. The learning curve is definitely steep if you jump in without guidance or the right approach. What helped me tremendously was using <a href="https://keybr.com">keybr.com</a>, a website that lets you practice individual letters, then letter combinations, making the learning process structured and manageable. After spending several afternoons practicing over the course of a week, my typing speed bounced back quickly. From around 29W PM in Day 2, typing speed managed to consistently get around 80 WPM 8 days after.</p> <p>Within about a month, I was hitting close to 100 WPM, and after roughly three months, I topped out around 115 WPM.</p> <p>Bluetooth connectivity is awesome, with multiple channels supported, though I occasionally have to restart the two halves due to minor latency hiccups. Battery life is great ‚Äî from my experience, it lasts roughly a month of daily use without RGB underglow. RGB lighting definitely drains the battery faster. The left half needs charging more often since it acts as the ‚Äúbrain‚Äù of the keyboard, managing the Bluetooth connection and communication with the right half. The transparent casings of the switches really help the RGBs shine through, and you get a plethora of colors to choose from for the underglow, as well as different degrees of illumination.</p> <p>The package also comes with a generous accessory kit, including 6 white-labeled keycaps, USB-C cable for charging, a keycap puller, twelve extra feet for high-angle and custom mounting, a set of extra threaded rods and nuts for high-angle mounting (my opinion on this in a moment), an M4 spanner and lastly four extra blank MCC keycaps and two blank MBK keycaps to serve as homing keys.</p> <h3 id="pros">Pros</h3> <ul> <li> <p><b>Keycaps and Typing Feel</b>: The keycaps feel absolutely wonderful‚Äîlike typing on a cloud. This soft, tactile experience is unlike any other keyboard I‚Äôve used. The concave keywells perfectly cradle the fingers, enhancing comfort and accuracy.</p> </li> <li> <p><b>Thumb Cluster</b>: The 6-key, 2-row curved thumb cluster is a joy to use. All keys are within easy reach, significantly improving typing ergonomics and speed.</p> </li> <li> <p><b>Wireless and Connectivity</b>: Bluetooth and USB-C options work reliably, with impressive battery life‚Äîabout a month of daily use without RGB lighting.</p> </li> <li> <p><b>Customizability</b>: Detachable palm rests, adjustable tenting, and a variety of key switches offer a level of customization rarely found at this price point.</p> </li> <li> <p><b>Extras</b>: The package includes handy extras like a keycap puller, extra feet for high-angle mounting, O-rings, and replacement keycaps - small but thoughtful touches, all in two smooth grey pouches.</p> </li> </ul> <h3 id="cons">Cons</h3> <p>Some cons that I found over this 6 month usage period are:</p> <ul> <li> <p><b>Travel Case</b>: The included travel case is bulky and not really suitable for light travel. Unlike the clever foam-molded Dygma Defy case, the Glove80‚Äôs case feels oversized. I usually just wrap the keyboards in a cloth and toss them in my backpack instead. The case mainly stays home unless I‚Äôm traveling with carry-on luggage.</p> </li> <li> <p><b>Build Quality Issues</b>: The plastic body (excluding their lovely custom keycaps) feels somewhat cheap. There are noticeable mold inconsistencies, especially around the left thumb cluster‚Äôs outer edge. For a premium-priced keyboard, better finishing and material quality would be expected.</p> </li> <li> <p><b>Tenting Mechanism</b>: Although adjustable, the tenting system is rather basic‚Äîjust three screws that can loosen over time, requiring frequent readjustment. The suggested fix involving nuts doesn‚Äôt feel like a well-thought-out solution for long-term stability.</p> </li> <li> <p><b>Non-Swappable Switches</b>: Some users prefer hot-swappable switches to easily try different feels or replace faulty switches. The Glove80‚Äôs switches are soldered, limiting this flexibility.</p> </li> </ul> <h3 id="closing-thoughts">Closing Thoughts</h3> <p> The Glove80 is a lovely piece of tech, and although not experienced with other ergonomic options, I can understand why it is regarding as a highly comfortable keyboard. While it has a few quirks‚Äîlike the bulky travel case and some build quality issues‚Äîthe overall comfort, key feel, and thoughtful ergonomic design really outweigh these minor flaws. I hope the founders of MoErgo (the company behind the Glove80) address these issues in the next versions and as the product matures. Paired with my <a href="https://www.logitech.com/en-us/products/mice/mx-vertical-ergonomic-mouse.910-005447.html" target="_blank" rel="noopener noreferrer">Logitech MX Vertical</a> ergonomic mouse, positioned comfortably between the two halves, I feel like saying goodbye to any discomfort. The learning curve is definitely a bit steep but in the end rewarding, as the typing experience, comfort and efficiency cannot really be compared to the average keyboard.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[It truly fits like a glove.]]></summary></entry><entry><title type="html">Gradient Wars - Reparametrization vs REINFORCE</title><link href="https://nkougioulis.com/blog/2025/gradient-estimation/" rel="alternate" type="text/html" title="Gradient Wars - Reparametrization vs REINFORCE"/><published>2025-01-03T09:12:00+00:00</published><updated>2025-01-03T09:12:00+00:00</updated><id>https://nkougioulis.com/blog/2025/gradient-estimation</id><content type="html" xml:base="https://nkougioulis.com/blog/2025/gradient-estimation/"><![CDATA[<p>Happy new year üéâüéáüéÜ! I was cleaning the dust out of some past handwritten notes on REINFORCE, when I decided to write up this short post, comparing the method against the known reparametrization trick, most often seen in training Variational Autoencoders.</p> <p>Variational Autoencoders (VAEs), introduced by Kingma and Welling <d-cite key="kingma2013auto"></d-cite>, are a class of deep latent variable models consisting of two coupled, independently parametrized components: an encoder(recognition model) and a decoder (generative model). Without going out of scope with details, the true posterior distribution over the latent variables is intractable to compute directly, so a variational approximation is used instead. A concrete example would be a prior \(p(z)\) as an isotropic Gaussian distribution and the stochastic encoder is modeled as a multivariate normal \(\mathcal{N}(\mu_\theta(z), \text{diag}(\sigma_\phi(z)))\), where \(\mu_\theta(z)\) and \(\sigma_\phi(z)\) are neural networks. The decoder is similarly structured with a neural network mapping the latent variable \(z\) back to the data space, thus enabling efficient learning of both the generative process and the inference model.</p> <p>As an image is a thousand words, I directly borrow an <a href="https://medium.com/@elzettevanrensburg/generating-the-intuition-behind-variational-auto-encoders-vaes-c7d2f8631a87">excellent illustration</a> of a Probabilistic Autoencoder by Elzette van Rensburg, as discussed before.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/vae-illustration.webp" sizes="95vw"/> <img src="/assets/img/vae-illustration.webp" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="the-problem">The Problem</h2> <p>Consider a random variable \(z \sim p_\theta (z)\), where \(p_\theta\) is a parametric distribution and a function \(f\), for which we wish to compute the gradient of its expected value. For instance, \(f\) may express a cost function such as the likelihood. If our aim is to minimize the likelihood \(L(\theta) = \mathbb{E}_{z \sim p_{\theta}(z)}[f(z)]\), or more formally \(\min \left\{ L(\theta) = \mathbb{E}_{Z \sim p_{\theta (z)}} [f(z)] \right\}_\theta\), then we are interested in evaluating (or at least, estimating) the gradient</p> \[\nabla_\theta \mathbb{E}_{z \sim p_{\theta}(z)}[f(z)]\] <p>where the variable notation \(z\) is used to refer to computing the expected value from a variable in the latent space. The issue here lies in computing the expectation with respect to the parameter distribution \(p(z)\), making it inherently stochastic instead of deterministic. That‚Äôs where path-derivative gradient estimators come to the rescue.</p> <h2 id="the-reparametrization-trick">The Reparametrization trick</h2> <p>The reparametrization trick can be briefly expressed as follows: If the distribution is reparameterizable, then \(z = g(\theta, \epsilon)\), where \(g\) is a deterministic function of parameters \(\theta\) and \(\epsilon\) is an independent random variable (noise). This leads to:</p> \[\frac{\partial}{\partial \theta} \mathbb{E}_{z \sim p_\theta(z)}[f(z)] = \frac{\partial}{\partial \theta} \mathbb{E}_\epsilon [f(g(\theta, \epsilon))]\] <p>Which simplifies to:</p> \[\mathbb{E}_{\epsilon \sim p_\epsilon} \left[ \frac{\partial f}{\partial g} \frac{\partial g}{\partial \theta} \right]\] <p>Thus, \(z\) is reparameterized as a function of \(\epsilon\), and the stochasticity of \(p_\theta\) is pushed to the distribution \(q(\epsilon)\), where \(q\) can be chosen as any random noise distribution. For example, if \(Z \sim N(\mu, \sigma^2)\), then \(z = \mu + \sigma \cdot N(0, 1)\). Another example would be, for a uniformly distributed variable \(U \sim U(a,b)\), that \(u = a + (b - a) \cdot U(0, 1)\).</p> <p>This bright trick alters the expectation to a distribution independent of \(\theta\), which can now be computed using Monte Carlo estimation, provided that \(f(g_\theta(\epsilon))\) is differentiable with respect to \(\theta\). Assuming a batch sample of size \(N\), the gradient estimator is</p> \[\nabla_\theta \mathbb{E}_{x \sim p(x)}[f(x)] \approx \frac{1}{N} \sum_{i=1}^{N} \nabla_\theta f(g_\theta(\epsilon_i))\] <p>The reparametrization trick belongs to the family of Path-derivative gradient estimators. Path-derivative estimators focus on how the expected value of a function changes as a parameter of the underlying distribution changes. This is done by considering a ‚Äúpath‚Äù through the parameter space. By expressing the sampled value as a deterministic function of a differentiable random variable, it creates a smooth and differentiable path for the sampling process.</p> <p>A really intuitive illustration of the above, borrowed from the excellent writing of Kingma and Welling <d-cite key="kingma2019introduction"></d-cite> is shown here:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/reparameterization-trick-480.webp 480w,/assets/img/reparameterization-trick-800.webp 800w,/assets/img/reparameterization-trick-1200.webp 1200w," type="image/webp" sizes="95vw"/> <img src="/assets/img/reparameterization-trick.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p><br/></p> <h2 id="score-function-estimator---reinforce">Score function Estimator - REINFORCE</h2> <p>Another gradient estimation method is the <strong>score-function estimator (SF)</strong> (also known as <strong>likelihood-ratio</strong>, or more commonly, <strong>REINFORCE</strong>) <d-cite key="williams1992simple"></d-cite>, which exploits the log-derivative property. It relies on the score-function (gradient of the log-likelihood) to estimate the gradient, without expressing the random variable as a function of a differentiable random variable (as in path-derivative estimators).</p> <p>The differentiation rule of the logarithm is \(\nabla_\theta \log p_\theta(z)= \frac{\nabla_\theta p_\theta(z)}{p_\theta(z)} \Rightarrow \nabla_\theta p_\theta(z) = p_\theta(z) \nabla_\theta \log p_\theta(z)\), where \(\nabla_\theta \log p_\theta(z)\) is known as the score-function. Hence we can rewrite the gradient as</p> \[\nabla_\theta \mathbb{E}_Z [f(z)] = \mathbb{E}_Z \left[ f(z) \nabla_\theta \log p_\theta(z) \right]\] <p>REINFORCE only requires that \(p_\theta(z)\) is differentiable with respect to the parameters \(\theta\), and it does not require backpropagating through \(f\) at the sample \(z\). It must also be easy to sample from \(p_\theta(z)\). Just like before, for a sample batch of size \(N\), we approximate the expectation as</p> \[\mathbb{E}_Z \left[ f(z) \nabla_\theta \log p_\theta(z) \right] \approx \frac{1}{N} \sum_{i=1}^{N} f(x_i) \nabla_\theta \log p_\theta(x_i)\] <p>which is an <strong>unbiased estimator</strong> of the gradient (in plain terms, for infinite sample size the above expected value is the same as the true gradient). Although unbiased, known drawback of REINFORCE is high variance of the estimation, leading to slow training convergence for relatively small samples. Finally, it is worth noting that the variance of SF can be reduced by substracting a <strong>control variate</strong> \(b(z)\) as follows:</p> \[\begin{split} \nabla_\theta \mathbb{E}_Z [f(z)] &amp;= \mathbb{E}_Z [f(z) \nabla_\theta \log p_\theta(z)] \\ &amp;= \mathbb{E}_Z [f(z) \nabla_\theta \log p_\theta(z) + b(z) \nabla_\theta \log p_\theta (z) - b(z) \nabla_\theta \log p_\theta(z)] \\ &amp;= \mathbb{E}_Z [(f(z) - b(z)) \nabla_\theta \log p_\theta (z) ] + \mu_b \end{split}\] <p>where \(\mu_b \equiv \mathbb{E}_Z [b(z) \nabla_\theta \log p_\theta(z)]\). Known estimators with control variates are NVIL <d-cite key="mnih2014neural"></d-cite>, MuProp <d-cite key="gu2015muprop"></d-cite>(unbiased), VIMCO <d-cite key="mnih2016variational"></d-cite> among others.</p> <p>¬†</p>]]></content><author><name></name></author><category term="Comments"/><category term="VAEs"/><category term="gradient-estimation"/><category term="reparametrization-trick"/><category term="reinforce"/><summary type="html"><![CDATA[A ride through gradient estimators]]></summary></entry><entry><title type="html">First post</title><link href="https://nkougioulis.com/blog/2024/first-post/" rel="alternate" type="text/html" title="First post"/><published>2024-12-28T10:00:00+00:00</published><updated>2024-12-28T10:00:00+00:00</updated><id>https://nkougioulis.com/blog/2024/first-post</id><content type="html" xml:base="https://nkougioulis.com/blog/2024/first-post/"><![CDATA[<p>Just getting started. Personal thoughts and notes expected here üôÇ.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[Just getting started. Personal thoughts and notes expected here üôÇ.]]></summary></entry></feed>